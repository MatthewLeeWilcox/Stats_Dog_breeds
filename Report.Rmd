---
title: "Breeds impact on adoption"
author: "Matthew Wilcox, Randy Otoo, Anthony Barrios, Arianne PozziBarba"
output: pdf_document
---

# Libraries

```{r}
library(tidyverse)
library(knitr)
library(kableExtra)

```
# Import and Clean Data

```{r}
animal_intake.df <- read_csv("Louisville_Metro_ky_-_Animal_Service_Intake_and_Outcome.csv")

```

```{r}
dog_intake.df <- animal_intake.df %>% filter(animaltype == "DOG") %>% 
  mutate(indate = str_remove(indate, " .*"),
         outdate = str_remove(outdate, " .*"),
         indate = as.Date(indate, format = "%Y/%m/%d"),
         outdate = as.Date(outdate, format = "%Y/%m/%d"),
         timeHeld = outdate - indate
         )%>%
  filter(intype == "STRAY", 
         outtype != "DISPOSAL") %>%
  select(outtype, sex, bites, petsize, color, breed, timeHeld)


```

# Probability

```{r}
pitbull_adopt_euth <- dog_intake.df %>%
  select(outtype, breed) %>%
  filter(
    outtype == "ADOPTION" | outtype == "EUTH"
  ) %>%
  mutate(breed = case_when(
    grepl("PIT BULL", breed) ~ "Is Pitbull",
    TRUE ~ "Not Pitbull"
  ))%>% group_by(outtype, breed) %>%
  summarise(n = n()) %>%
  pivot_wider(names_from = breed, values_from = n) %>%
  column_to_rownames(., var = "outtype")

pitbull_adopt_euth %>% kbl(caption = "Frequency Table of Pitbull and Adoption") %>%  kable_classic_2(full_width = F)


```
Null Hypothesis (H0): The populations average length of stay for Pit Bulls is equal to the general populations average length of stay.
Alternative Hypothesis (HA): The populations average length of stay for Pit Bulls is different from the general population's average length of stay

```{r}
dog_intake.df <- dog_intake.df %>%
  mutate(Pitbull = ifelse(grepl("PIT BULL", breed), "Pitbull", "Other Breed"))
pitbull_data <- dog_intake.df %>%
  filter(Pitbull == "Pitbull") %>%
  select(timeHeld)

other_breeds_data <- dog_intake.df %>%
  filter(Pitbull == "Other Breed") %>%
  select(timeHeld)
t_test_pitbull_vs_other_breeds <- t.test(pitbull_data$timeHeld, other_breeds_data$timeHeld)
t_test_pitbull_vs_other_breeds

```
We reject the null hypothesis because we have a small p-value (p < 0.05) This means there's significant evidence to suggest that the average stay duration of Pit bulls differs from the average stay duration of other dog breeds in the Louisville metro area.
```{r}
#Confidence interval
n <- sum(!is.na(dog_intake.df$timeHeld)) 
mean_stay <- mean(dog_intake.df$timeHeld, na.rm = TRUE) 
sd_stay <- sd(dog_intake.df$timeHeld, na.rm = TRUE)  

lower_ci <- mean_stay - qt(0.975, df = n - 1) * (sd_stay / sqrt(n))
upper_ci <- mean_stay + qt(0.975, df = n - 1) * (sd_stay / sqrt(n))

lower_ci 
upper_ci  

```

